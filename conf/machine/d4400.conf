#@TYPE: Machine
#@NAME: i.MX6Q
#@DESCRIPTION: Machine configuration for Freescale

include conf/machine/include/fsl-dfe-base.inc
include conf/machine/include/tune-cortexa9.inc
include conf/machine/include/fsl-dfe-release.inc

SOC_FAMILY = "mx6:mx6q"


PREFERRED_PROVIDER_virtual/kernel_d4400 ?= "linux-dfe"
PREFERRED_PROVIDER_u-boot_d4400 ?= "u-boot-dfe"

PEFERRED_VERSION_virtual/kernel_linux-dfe ?= "3.8.4"
PEFERRED_VERSION_u-boot_u-boot-dfe ?= "2013.04"

KERNEL_DEVICETREE = "${S}/arch/arm/boot/dts/d4400-evb.dts"
KERNEL_DEFCONFIG = "${S}/arch/arm/configs/d4400_evb_defconfig"
UBOOT_MACHINE = "d4400_evb_config"
# Set specific make target and binary suffix
UBOOT_MAKE_TARGET = "all"
UBOOT_SUFFIX ?= "d4400"
UBOOT_BINARY ?= "u-boot-sha256.${UBOOT_SUFFIX}"
UBOOT_IMAGE ?= "u-boot-sha256-${DATETIME}.${UBOOT_SUFFIX}"
UBOOT_ENTRYPOINT = "0x17800000"
KERNEL_EXTRA_ARGS = "LOADADDR=0x90008000 -j3"

ROOTFS_POSTPROCESS_COMMAND += "cd ${IMAGE_ROOTFS} ; rm -rf home ; ln -s mnt/pfs/home home ; mkdir -m 755 mnt/pfs ; "
ROOTFS_POSTPROCESS_COMMAND += "cd ${IMAGE_ROOTFS} ; ln -s /mnt/pfs/etc/init.d/custom_init.sh etc/rcS.d/S36custom_init.sh ; "
ROOTFS_POSTPROCESS_COMMAND += "cd ${IMAGE_ROOTFS} ; cd etc ; unlink syslog-startup.conf; ln -s mysyslog.conf syslog-startup.conf ; cd .. ; "
CORE_IMAGE_EXTRA_INSTALL  += "swig lua5.1 ncurses readline rrh-utils openssh ethtool mtd-utils nano perf"
